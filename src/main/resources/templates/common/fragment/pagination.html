<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!-- tbody 안에 들어갈 “행들만” 렌더 -->
<th:block th:fragment="initialTbody(pageData)">
    <!-- 반복은 block에서 하고, row는 replace로만 부르기 -->
    <th:block th:each="u : ${pageData.content}">
        <tr th:replace="~{user/row :: row(u=${u})}"></tr>
    </th:block>
</th:block>

<!-- nav 안에 들어갈 페이징 마크업(ul 이하만) -->
<th:block th:fragment="pager(pageData, sort, dir, q, size)">
    <ul class="pagination justify-content-center my-3">

        <!-- 처음/이전 -->
        <!-- hasPrev가 없으면 disabled 추가 -->
        <li class="page-item" th:classappend="${!pageData.hasPrev} ? ' disabled'">
            <!-- 원래 페이지가 새로고침되지만 스크립트 단에서 preventDefault()로 막음 -->
            <a class="page-link"
               th:href="@{/user(page=${0}, size=${pageData.size}, sort=${sort}, dir=${dir}, q=${q})}"
               aria-label="First">&laquo;</a>
        </li>
        <li class="page-item" th:classappend="${!pageData.hasPrev} ? ' disabled'">
            <a class="page-link"
               th:href="@{/user(page=${pageData.page - 1}, size=${pageData.size}, sort=${sort}, dir=${dir}, q=${q})}"
               aria-label="Previous">&lsaquo;</a>
        </li>

        <!-- 페이지 숫자 -->
        <li class="page-item"
            th:each="i : ${#numbers.sequence(0, pageData.totalPages - 1)}"
            th:classappend="${i == pageData.page} ? ' active'">
            <!-- 백엔드는 0부터 시작하므로, 1부터 시작하는 UI를 위해 +1 -->
            <a class="page-link"
               th:href="@{/user(page=${i}, size=${pageData.size}, sort=${sort}, dir=${dir}, q=${q})}"
               th:text="${i + 1}">1</a>
        </li>

        <!-- 다음/마지막 -->
        <li class="page-item" th:classappend="${!pageData.hasNext} ? ' disabled'">
            <a class="page-link"
               th:href="@{/user(page=${pageData.page + 1}, size=${pageData.size}, sort=${sort}, dir=${dir}, q=${q})}"
               aria-label="Next">&rsaquo;</a>
        </li>
        <li class="page-item" th:classappend="${!pageData.hasNext} ? ' disabled'">
            <a class="page-link"
               th:href="@{/user(page=${pageData.totalPages - 1}, size=${pageData.size}, sort=${sort}, dir=${dir}, q=${q})}"
               aria-label="Last">&raquo;</a>
        </li>
    </ul>
</th:block>

</body>
</html>
